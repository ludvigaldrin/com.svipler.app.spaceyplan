<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="/homey.js" data-origin="settings"></script>
    <link rel="stylesheet" type="text/css" href="./css/settings.css">
</head>
<body>
    <!-- Main Floor List View -->
    <div id="floorsListView" class="homey-section">
        <div class="homey-form-group">
            <div class="header-with-button">
                <h1 class="homey-title">Floor Plans</h1>
                <button id="addFloor" class="icon-button add-button" title="Add New Floor">
                    <svg width="24" height="24" viewBox="0 0 24 24">
                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                    </svg>
                </button>
            </div>
            <div id="floorsList" class="floors-grid">
                <!-- Empty state message -->
                <div id="emptyState" class="empty-state">
                    <svg width="64" height="64" viewBox="0 0 24 24" class="empty-state-icon">
                        <path d="M14 6l-4.22 5.63 1.25 1.67L14 9.33 19 16h-8.46l-4.01-5.37L1 18h22L14 6zM5 16l1.52-2.03L8.04 16H5z"/>
                    </svg>
                    <h2 class="empty-state-title">Welcome to Space Homey!</h2>
                    <p class="empty-state-text">Create your first floor plan to start mapping your smart home devices</p>
                    <p class="empty-state-sub">Click the + button above to get started</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Floor Edit View -->
    <div id="floorEditView" class="homey-section" style="display: none;">
        <div class="view-header">
            <button id="backToList" class="icon-button back-button" title="Back to List">
                <svg width="24" height="24" viewBox="0 0 24 24">
                    <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                </svg>
            </button>
            <h1 class="homey-title" id="editViewTitle">Edit Floor Plan</h1>
        </div>

        <div class="edit-content">
            <div class="homey-form-group">
                <label class="homey-form-label" for="editFloorName">Floor Name</label>
                <input type="text" id="editFloorName" class="homey-form-input">
            </div>

            <div id="floorPlanContainer">
                <div id="imageWrapper" class="image-wrapper">
                    <img id="floorMapImage" class="floor-map" src="" alt="Floor Plan">
                    <div id="floorPlanDevices"></div>
                </div>
            </div>

            <div style="text-align: center;"><small>Press the name in the list to highlight them</small></div>

            <div class="devices-section">
                <div class="section-header">
                    <h2 class="homey-subtitle">Devices</h2>
                    <button id="addDevice" class="icon-button" title="Add Device">
                        <svg width="24" height="24" viewBox="0 0 24 24">
                            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                    </button>
                </div>
                <div id="devicesList" class="devices-list"></div>
            </div>
        </div>
    </div>

    <!-- New Floor Dialog -->
    <div id="newFloorDialog" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Floor</h2>
                <button class="close-button">×</button>
            </div>
            <div class="modal-body">
                <div class="homey-form-group">
                    <label class="homey-form-label" for="floorName">Floor Name</label>
                    <input type="text" id="floorName" class="homey-form-input" placeholder="e.g., Ground Floor">
                </div>
                <div class="homey-form-group">
                    <label class="homey-form-label">Floor Plan Image</label>
                    <input type="file" id="floorImage" accept="image/*" class="homey-form-input">
                    <div id="imagePreview"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="button button-secondary" id="cancelNewFloor">Cancel</button>
                <button class="button button-primary" id="saveNewFloor">Create Floor</button>
            </div>
        </div>
    </div>

    <!-- Device Selection Dialog -->
    <div id="deviceDialog" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add Device</h2>
                <button class="close-button">×</button>
            </div>
            <div class="modal-body">
                <div class="rule-type-selector">
                    <label>Search Devices</label>
                    <input type="text" id="deviceSearch" class="homey-form-input" placeholder="Type to search devices...">
                </div>
                <div id="searchResults" class="search-results">
                    <div class="initial-state">Start typing to search for devices</div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="button button-secondary" id="cancelDeviceDialog">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Dialog -->
    <div id="deleteConfirmDialog" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Delete Floor Plan</h2>
                <button class="close-button">×</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this floor plan? This action cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button class="button button-secondary" id="cancelDelete">Cancel</button>
                <button class="button button-danger" id="confirmDelete">Delete</button>
            </div>
        </div>
    </div>

    <script src="./js/settings.js" type="text/javascript"></script>
</body>
</html> 